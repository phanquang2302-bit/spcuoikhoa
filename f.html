<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Đăng nhập / Đăng ký</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #ff6600, #ff9966);
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0;
    }
    .container {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      width: 400px;
      overflow: hidden;
      padding: 20px;
      transition: 0.3s;
    }
    .tab {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
      cursor: pointer;
    }
    .tab div {
      flex: 1;
      text-align: center;
      padding: 10px;
      font-weight: bold;
      border-bottom: 2px solid transparent;
      transition: 0.2s;
    }
    .tab div.active {
      border-bottom: 2px solid #ff6600;
      color: #ff6600;
    }
    form {
      display: none;
      flex-direction: column;
    }
    form.active {
      display: flex;
    }
    input {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    button {
      background: #ff6600;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover {
      background: #ff8533;
    }
    #error-message {
      color: red;
      display: none;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="tab">
      <div id="login-tab" class="active">Đăng nhập</div>
      <div id="register-tab">Đăng ký</div>
    </div>

    <!-- Form đăng nhập -->
    <form id="login-form" class="active">
      <input type="text" placeholder="Tên đăng nhập" required />
      <input type="password" placeholder="Mật khẩu" required />
      <button type="submit">Đăng nhập</button>
    </form>

    <!-- Form đăng ký -->
    <form id="register-form">
      <input type="text" id="username" placeholder="Tên đăng kí (6-18 ký tự)" required />
      <input type="email" placeholder="Email" required />
      <input type="password" id="password" placeholder="Mật khẩu (6-18 ký tự)" required />
      <input type="password" id="confirm-password" placeholder="Xác nhận mật khẩu" required>
      <button type="submit">Đăng ký</button>
      <p id="error-message">Thông báo lỗi</p>
    </form>
  </div>

  <script>
    const loginTab = document.getElementById('login-tab');
    const registerTab = document.getElementById('register-tab');
    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    const errorMessage = document.getElementById('error-message');

    // Chuyển tab
    loginTab.onclick = () => {
      loginTab.classList.add('active');
      registerTab.classList.remove('active');
      loginForm.classList.add('active');
      registerForm.classList.remove('active');
      errorMessage.style.display = 'none';
    };

    registerTab.onclick = () => {
      registerTab.classList.add('active');
      loginTab.classList.remove('active');
      registerForm.classList.add('active');
      loginForm.classList.remove('active');
      errorMessage.style.display = 'none';
    };

    // Mã hóa mật khẩu Base64
    function encodePassword(pass) {
      return btoa(pass);
    }

    // Đăng ký
    registerForm.onsubmit = function(event) {
      event.preventDefault();
      const user = document.getElementById("username").value.trim();
      const pass = document.getElementById("password").value;
      const confirmPass = document.getElementById("confirm-password").value;

      if (user.length < 6 || user.length > 18) {
        errorMessage.innerText = "Tên đăng nhập phải từ 6 đến 18 ký tự.";
        errorMessage.style.display = "block";
        return false;
      }
      if (pass.length < 6 || pass.length > 18) {
        errorMessage.innerText = "Mật khẩu phải từ 6 đến 18 ký tự.";
        errorMessage.style.display = "block";
        return false;
      }
      if (pass !== confirmPass) {
        errorMessage.innerText = "Mật khẩu không trùng khớp!";
        errorMessage.style.display = "block";
        return false;
      }

      // Lưu username và mật khẩu mã hóa
      localStorage.setItem("username", user);
      localStorage.setItem("password", encodePassword(pass));

      alert("Đăng ký thành công! Hãy đăng nhập.");
      registerForm.reset();
      loginTab.click();
    }

    // Đăng nhập
    loginForm.onsubmit = function(event) {
      event.preventDefault();
      const inputUser = loginForm.querySelector("input[type='text']").value.trim();
      const inputPass = loginForm.querySelector("input[type='password']").value;

      const storedUser = localStorage.getItem("username");
      const storedPass = localStorage.getItem("password");

      if (inputUser === storedUser && encodePassword(inputPass) === storedPass) {
        alert("Đăng nhập thành công!");
        window.location.href = "home.html"; // Chuyển sang trang home
      } else {
        errorMessage.innerText = "Sai tên đăng nhập hoặc mật khẩu!";
        errorMessage.style.display = "block";
      }
    }
  </script>
</body>
</html>